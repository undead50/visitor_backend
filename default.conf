
upstream node-app {
    server signature:5500;
}

server {

    listen 5090;
    server_name 172.28.1.67;
    client_max_body_size 25M;

    # Add this line to pass the real client IP to Node.js
    proxy_set_header        Host               $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    ### Pointing to react build ###
    root /var/www/build;
    location / {
        #set_real_ip_from 0.0.0.0/0;
        #set $client_ip $remote_addr;
        #real_ip_header X-Forwarded-for;
        #real_ip_recursive on;
        try_files $uri /index.html;
    }
    ### Pointing to react build ###
    real_ip_header X-Forwarded-For;
    real_ip_recursive on;
    set_real_ip_from 0.0.0.0/0;
    location /backend/ {
        #set_real_ip_from 0.0.0./0;
        #set $client_ip $remote_addr;
        #real_ip_header X-Forwarded-for;
        #real_ip_recursive on;
        #set_real_ip_from  10.0.0.0/8; # Replace with your trusted proxy IP range
        #real_ip_header    X-Forwarded-For;
        #real_ip_recursive on;
        proxy_pass http://node-app/;
        proxy_set_header        Host               $host;
        proxy_set_header        X-Real-IP          $remote_addr;
        proxy_set_header        X-Forwarded-For    $proxy_add_x_forwarded_for;
        # proxy_set_header        X-Forwarded-Host   $host:443;
        # proxy_set_header        X-Forwarded-Server $host;
        # proxy_set_header        X-Forwarded-Port   443;
        # proxy_set_header        X-Forwarded-Proto  https;

    }

}
